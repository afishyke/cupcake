2025-06-20 00:49:42,197 - INFO - Logging to: /home/abhishek/projects/CUPCAKE/logs/enhanced_historical_data_fetcher_20250620_004942_IST.log
2025-06-20 00:49:42,198 - INFO - Script directory: /home/abhishek/projects/CUPCAKE/scripts
2025-06-20 00:49:42,198 - INFO - Looking for symbols.json at: /home/abhishek/projects/CUPCAKE/scripts/symbols.json
2025-06-20 00:49:42,198 - INFO - Loaded credentials from /home/abhishek/projects/CUPCAKE/authentication/credentials.json
2025-06-20 00:49:42,198 - INFO - Loaded 15 symbols from /home/abhishek/projects/CUPCAKE/scripts/symbols.json
2025-06-20 00:49:42,200 - INFO - Connected to Redis at localhost:6379, DB 0
2025-06-20 00:49:42,200 - INFO - Flushed Redis database
2025-06-20 00:49:42,200 - INFO - Starting enhanced data fetch at 2025-06-20 00:49:42.200848
2025-06-20 00:49:42,200 - INFO - Starting to process 15 symbols with 3 workers
2025-06-20 00:49:42,201 - INFO - Processing symbol: Reliance Industries (NSE_EQ|INE002A01018)
2025-06-20 00:49:42,201 - INFO - Processing symbol: Tata Consultancy Services (NSE_EQ|INE467B01029)
2025-06-20 00:49:42,201 - INFO - Processing symbol: Infosys (NSE_EQ|INE009A01021)
2025-06-20 00:49:42,320 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:42,321 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:42,321 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:42,321 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:42,344 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:42,345 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:42,492 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:42,496 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:42,496 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:42,520 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:42,522 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:42,522 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:42,535 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:42,537 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:42,540 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:42,559 - INFO - Added 250 candles for Tata_Consultancy_Services
2025-06-20 00:49:42,564 - INFO - Processing symbol: HDFC Bank (NSE_EQ|INE040A01034)
2025-06-20 00:49:42,565 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:42,567 - INFO - Progress: 1/15 symbols processed
2025-06-20 00:49:42,567 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:42,584 - INFO - Added 250 candles for Infosys
2025-06-20 00:49:42,587 - INFO - Processing symbol: ICICI Bank (NSE_EQ|INE090A01021)
2025-06-20 00:49:42,587 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:42,587 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:42,596 - INFO - Added 250 candles for Reliance_Industries
2025-06-20 00:49:42,596 - INFO - Processing symbol: Hindustan Unilever (NSE_EQ|INE030A01027)
2025-06-20 00:49:42,596 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:42,596 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:42,737 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:42,742 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:42,747 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:42,757 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:42,762 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:42,767 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:42,775 - INFO - Progress: 2/15 symbols processed
2025-06-20 00:49:42,779 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:42,781 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:42,785 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:42,827 - INFO - Added 250 candles for HDFC_Bank
2025-06-20 00:49:42,831 - INFO - Processing symbol: ITC (NSE_EQ|INE154A01025)
2025-06-20 00:49:42,831 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:42,831 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:42,846 - INFO - Added 250 candles for Hindustan_Unilever
2025-06-20 00:49:42,847 - INFO - Added 250 candles for ICICI_Bank
2025-06-20 00:49:42,848 - INFO - Processing symbol: State Bank of India (NSE_EQ|INE062A01020)
2025-06-20 00:49:42,848 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:42,848 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:42,850 - INFO - Processing symbol: Bharti Airtel (NSE_EQ|INE397D01024)
2025-06-20 00:49:42,850 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:42,850 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:42,949 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:42,950 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:42,950 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:42,979 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:42,981 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:42,981 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:42,979 - INFO - Progress: 3/15 symbols processed
2025-06-20 00:49:42,988 - INFO - Added 250 candles for ITC
2025-06-20 00:49:42,990 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:42,997 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:42,996 - INFO - Processing symbol: Kotak Mahindra Bank (NSE_EQ|INE237A01028)
2025-06-20 00:49:43,000 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:43,000 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:43,002 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:43,028 - INFO - Added 250 candles for Bharti_Airtel
2025-06-20 00:49:43,029 - INFO - Processing symbol: Larsen & Toubro (NSE_EQ|INE018A01030)
2025-06-20 00:49:43,029 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:43,029 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:43,033 - INFO - Added 250 candles for State_Bank_of_India
2025-06-20 00:49:43,034 - INFO - Processing symbol: Asian Paints (NSE_EQ|INE021A01026)
2025-06-20 00:49:43,034 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:43,034 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:43,137 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:43,142 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:43,143 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:43,163 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:43,167 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:43,168 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:43,195 - INFO - Progress: 4/15 symbols processed
2025-06-20 00:49:43,195 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:43,212 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:43,213 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:43,321 - INFO - Added 250 candles for Kotak_Mahindra_Bank
2025-06-20 00:49:43,324 - INFO - Processing symbol: Maruti Suzuki (NSE_EQ|INE585B01010)
2025-06-20 00:49:43,324 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:43,328 - INFO - Added 250 candles for Larsen_and_Toubro
2025-06-20 00:49:43,328 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:43,339 - INFO - Processing symbol: Bajaj Finance (NSE_EQ|INE296A01024)
2025-06-20 00:49:43,339 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:43,340 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:43,374 - INFO - Added 250 candles for Asian_Paints
2025-06-20 00:49:43,376 - INFO - Processing symbol: HCL Technologies (NSE_EQ|INE860A01027)
2025-06-20 00:49:43,376 - INFO - Need 250 more candles from historical data
2025-06-20 00:49:43,377 - INFO - Fetching historical data from 2025-06-18 to 2025-06-20
2025-06-20 00:49:43,408 - INFO - Progress: 5/15 symbols processed
2025-06-20 00:49:43,451 - ERROR - V3 Historical API failed for NSE_EQ|INE296A01024: 400 Client Error: Bad Request for url: https://api.upstox.com/v3/historical-candle/NSE_EQ%7CINE296A01024/minutes/1/2025-06-20/2025-06-18
2025-06-20 00:49:43,480 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:43,485 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:43,485 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:43,532 - INFO - V3 Historical: Got 750 candles
2025-06-20 00:49:43,537 - INFO - Final dataset: 250 candles from 2025-06-19 11:20:00+05:30 to 2025-06-19 15:29:00+05:30
2025-06-20 00:49:43,542 - WARNING - ⚠ Latest data is from 2025-06-19, not today (2025-06-20)
2025-06-20 00:49:43,568 - ERROR - V2 Historical API failed for NSE_EQ|INE296A01024: 400 Client Error: Bad Request for url: https://api.upstox.com/v2/historical-candle/NSE_EQ%7CINE296A01024/1minute/2025-06-20/2025-06-18
2025-06-20 00:49:43,569 - WARNING - No data received for Bajaj Finance
2025-06-20 00:49:43,593 - INFO - Added 250 candles for Maruti_Suzuki
2025-06-20 00:49:43,609 - INFO - Progress: 6/15 symbols processed
2025-06-20 00:49:43,632 - INFO - Added 250 candles for HCL_Technologies
2025-06-20 00:49:43,810 - INFO - Progress: 7/15 symbols processed
2025-06-20 00:49:44,010 - INFO - Progress: 8/15 symbols processed
2025-06-20 00:49:44,211 - INFO - Progress: 9/15 symbols processed
2025-06-20 00:49:44,412 - INFO - Progress: 10/15 symbols processed
2025-06-20 00:49:44,612 - INFO - Progress: 11/15 symbols processed
2025-06-20 00:49:44,813 - INFO - Progress: 12/15 symbols processed
2025-06-20 00:49:45,013 - INFO - Progress: 13/15 symbols processed
2025-06-20 00:49:45,214 - INFO - Progress: 14/15 symbols processed
2025-06-20 00:49:45,415 - INFO - Progress: 15/15 symbols processed
2025-06-20 00:49:45,617 - INFO - Enhanced fetch completed in 0:00:03.415092. 14 successful, 1 failed
