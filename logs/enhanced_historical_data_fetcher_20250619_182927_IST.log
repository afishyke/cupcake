2025-06-19 18:29:27,119 - INFO - Logging to: logs\enhanced_historical_data_fetcher_20250619_182927_IST.log
2025-06-19 18:29:27,123 - INFO - Script directory: c:\Users\abhij\Desktop\knapi\cupcake\scripts
2025-06-19 18:29:27,123 - INFO - Looking for symbols.json at: keys\config\symbols.json
2025-06-19 18:29:27,124 - INFO - Loaded credentials from keys\credentials\credentials.json
2025-06-19 18:29:27,127 - INFO - Loaded 15 symbols from keys\config\symbols.json
2025-06-19 18:29:31,227 - ERROR - Failed to connect to Redis: Error 10061 connecting to localhost:6379. No connection could be made because the target machine actively refused it.
2025-06-19 18:29:31,680 - ERROR - Fatal error in enhanced main: Error 10061 connecting to localhost:6379. No connection could be made because the target machine actively refused it.
Traceback (most recent call last):
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\connection.py", line 385, in connect_check_health
    sock = self.retry.call_with_retry(
        lambda: self._connect(), lambda error: self.disconnect(error)
    )
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\retry.py", line 87, in call_with_retry
    return do()
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\connection.py", line 386, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            ~~~~~~~~~~~~~^^
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\connection.py", line 797, in _connect
    raise err
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\connection.py", line 781, in _connect
    sock.connect(socket_address)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\abhij\Desktop\knapi\cupcake\panel\..\scripts\historical_data_fetcher.py", line 754, in main
    fetcher = EnhancedHistoricalDataFetcher(CREDENTIALS_PATH, SYMBOLS_PATH)
  File "c:\Users\abhij\Desktop\knapi\cupcake\panel\..\scripts\historical_data_fetcher.py", line 462, in __init__
    self.redis_manager = RedisTimeSeriesManager()
                         ~~~~~~~~~~~~~~~~~~~~~~^^
  File "c:\Users\abhij\Desktop\knapi\cupcake\panel\..\scripts\historical_data_fetcher.py", line 345, in __init__
    self.redis_client.ping()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\commands\core.py", line 1219, in ping
    return self.execute_command("PING", **kwargs)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\client.py", line 623, in execute_command
    return self._execute_command(*args, **options)
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\client.py", line 629, in _execute_command
    conn = self.connection or pool.get_connection()
                              ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\utils.py", line 191, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\connection.py", line 1530, in get_connection
    connection.connect()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\connection.py", line 379, in connect
    self.connect_check_health(check_health=True)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\abhij\AppData\Local\Programs\Python\Python313\Lib\site-packages\redis\connection.py", line 391, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 10061 connecting to localhost:6379. No connection could be made because the target machine actively refused it.
