2025-06-19 10:21:08,571 - INFO - Live data fetcher logging to: /home/abhishek/projects/CUPCAKE/logs/live_data_fetcher_20250619_102108_IST.log
2025-06-19 10:21:08,572 - INFO - Script directory: /home/abhishek/projects/CUPCAKE/scripts
2025-06-19 10:21:08,572 - INFO - Looking for symbols.json at: /home/abhishek/projects/CUPCAKE/scripts/symbols.json
2025-06-19 10:21:08,572 - INFO - Loaded credentials from /home/abhishek/projects/CUPCAKE/authentication/credentials.json
2025-06-19 10:21:08,572 - INFO - Loaded 15 symbols from /home/abhishek/projects/CUPCAKE/scripts/symbols.json
2025-06-19 10:21:08,576 - INFO - Connected to Redis at localhost:6379, DB 0
2025-06-19 10:21:08,577 - INFO - Starting continuous live data fetching...
2025-06-19 10:21:08,577 - INFO - Monitoring 15 symbols
2025-06-19 10:21:08,577 - INFO - Log file: /home/abhishek/projects/CUPCAKE/logs/live_data_fetcher_20250619_102108_IST.log
2025-06-19 10:21:08,577 - INFO - Performing initial gap filling...
2025-06-19 10:21:08,685 - INFO - === Cycle 1 - 2025-06-19 10:21:08 IST ===
2025-06-19 10:21:08,686 - INFO - Processing 15 symbols with 3 workers
2025-06-19 10:21:08,814 - ERROR - Unexpected error fetching NSE_EQ|INE467B01029 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:08,815 - WARNING - No candle data received for Tata Consultancy Services at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:08,820 - ERROR - Unexpected error fetching NSE_EQ|INE009A01021 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:08,820 - WARNING - No candle data received for Infosys at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:08,836 - ERROR - Unexpected error fetching NSE_EQ|INE002A01018 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:08,836 - WARNING - No candle data received for Reliance Industries at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:08,899 - ERROR - Unexpected error fetching NSE_EQ|INE090A01021 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:08,900 - WARNING - No candle data received for ICICI Bank at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:08,905 - ERROR - Unexpected error fetching NSE_EQ|INE040A01034 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:08,905 - WARNING - No candle data received for HDFC Bank at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:08,926 - ERROR - Unexpected error fetching NSE_EQ|INE030A01027 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:08,926 - WARNING - No candle data received for Hindustan Unilever at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:08,986 - ERROR - Unexpected error fetching NSE_EQ|INE062A01020 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:08,986 - WARNING - No candle data received for State Bank of India at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:09,000 - ERROR - Unexpected error fetching NSE_EQ|INE154A01025 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:09,000 - WARNING - No candle data received for ITC at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:09,048 - ERROR - Unexpected error fetching NSE_EQ|INE397D01024 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:09,048 - WARNING - No candle data received for Bharti Airtel at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:09,074 - ERROR - Unexpected error fetching NSE_EQ|INE018A01030 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:09,074 - WARNING - No candle data received for Larsen & Toubro at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:09,091 - ERROR - Unexpected error fetching NSE_EQ|INE237A01028 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:09,092 - WARNING - No candle data received for Kotak Mahindra Bank at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:09,124 - ERROR - Unexpected error fetching NSE_EQ|INE021A01026 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:09,125 - WARNING - No candle data received for Asian Paints at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:09,156 - ERROR - Unexpected error fetching NSE_EQ|INE585B01010 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:09,156 - WARNING - No candle data received for Maruti Suzuki at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:09,176 - ERROR - Upstox V2 API error fetching NSE_EQ|INE296A01024 for 2025-06-19 09:15:00+05:30: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Date': 'Thu, 19 Jun 2025 04:51:09 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'vary': 'Origin, Access-Control-Request-Method, Access-Control-Request-Headers', 'message': 'request failed', 'requestid': '852db350-852f-4035-ba72-6debe047b5f4', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'Cache-Control': 'no-cache, no-store, max-age=0, must-revalidate', 'pragma': 'no-cache', 'expires': '0', 'strict-transport-security': 'max-age=0; includeSubDomains', 'x-frame-options': 'DENY', 'CF-Cache-Status': 'MISS', 'Set-Cookie': '__cf_bm=OHuBrEU2x..bSYPK.kB2olo8evO78I3Lqbyb0m1grrA-1750308669-1.0.1.1-tQPzsLXi1nzQFWBnW6aQIyvwY3DQ1zmI_tXqu485rCtjdatdDE5rLyM0L3JBB.qF; path=/; expires=Thu, 19-Jun-25 05:21:09 GMT; domain=.upstox.com; HttpOnly; Secure; SameSite=None, _cfuvid=78zWfRUVXxtslksQHLWH0xt9.8OuSjQNZedHdwIX6t0-1750308669144-0.0.1.1-604800000; path=/; domain=.upstox.com; HttpOnly; Secure; SameSite=None', 'Server': 'cloudflare', 'CF-RAY': '952068ddba8e2fe1-CNN', 'alt-svc': 'h3=":443"; ma=86400'})
HTTP response body: b'{"status":"error","errors":[{"errorCode":"UDAPI100011","message":"Invalid Instrument key","propertyPath":null,"invalidValue":null,"error_code":"UDAPI100011","property_path":null,"invalid_value":null}]}'

2025-06-19 10:21:09,203 - ERROR - Unexpected error fetching NSE_EQ|INE860A01027 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:21:09,203 - WARNING - No candle data received for HCL Technologies at 2025-06-19 10:20:00+05:30
2025-06-19 10:21:09,266 - ERROR - V3 fallback HTTP request failed for NSE_EQ|INE296A01024: 400 Client Error: Bad Request for url: https://api.upstox.com/v3/historical-candle/intraday/NSE_EQ%7CINE296A01024/minutes/1
2025-06-19 10:21:09,266 - WARNING - No candle data received for Bajaj Finance at 2025-06-19 09:15:00+05:30
2025-06-19 10:21:10,319 - INFO - Cycle 1 completed: 0/15 successful, 15 failed
2025-06-19 10:21:10,321 - INFO - Waiting 79.7 seconds until next fetch at 10:22:30
2025-06-19 10:22:30,080 - INFO - === Cycle 2 - 2025-06-19 10:22:30 IST ===
2025-06-19 10:22:30,080 - INFO - Processing 15 symbols with 3 workers
2025-06-19 10:22:30,194 - ERROR - Unexpected error fetching NSE_EQ|INE467B01029 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,194 - WARNING - No candle data received for Tata Consultancy Services at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,202 - ERROR - Unexpected error fetching NSE_EQ|INE009A01021 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,202 - WARNING - No candle data received for Infosys at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,223 - ERROR - Unexpected error fetching NSE_EQ|INE002A01018 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,223 - WARNING - No candle data received for Reliance Industries at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,276 - ERROR - Unexpected error fetching NSE_EQ|INE040A01034 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,276 - WARNING - No candle data received for HDFC Bank at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,291 - ERROR - Unexpected error fetching NSE_EQ|INE090A01021 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,291 - WARNING - No candle data received for ICICI Bank at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,352 - ERROR - Unexpected error fetching NSE_EQ|INE154A01025 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,352 - WARNING - No candle data received for ITC at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,355 - ERROR - Unexpected error fetching NSE_EQ|INE030A01027 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,355 - WARNING - No candle data received for Hindustan Unilever at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,393 - ERROR - Unexpected error fetching NSE_EQ|INE062A01020 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,394 - WARNING - No candle data received for State Bank of India at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,436 - ERROR - Unexpected error fetching NSE_EQ|INE237A01028 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,439 - ERROR - Unexpected error fetching NSE_EQ|INE397D01024 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,439 - WARNING - No candle data received for Kotak Mahindra Bank at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,440 - WARNING - No candle data received for Bharti Airtel at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,465 - ERROR - Unexpected error fetching NSE_EQ|INE018A01030 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,466 - WARNING - No candle data received for Larsen & Toubro at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,517 - ERROR - Unexpected error fetching NSE_EQ|INE021A01026 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,518 - WARNING - No candle data received for Asian Paints at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,532 - ERROR - Upstox V2 API error fetching NSE_EQ|INE296A01024 for 2025-06-19 09:15:00+05:30: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Date': 'Thu, 19 Jun 2025 04:52:30 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'vary': 'Origin, Access-Control-Request-Method, Access-Control-Request-Headers', 'message': 'request failed', 'requestid': 'a9bf4a92-e3e6-41fe-8863-c5325f7ed9fa', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'Cache-Control': 'no-cache, no-store, max-age=0, must-revalidate', 'pragma': 'no-cache', 'expires': '0', 'strict-transport-security': 'max-age=0; includeSubDomains', 'x-frame-options': 'DENY', 'CF-Cache-Status': 'MISS', 'Set-Cookie': '__cf_bm=U5OIlAUa5348z9VLtj.u2gfxxwe5yBeVGobBauYt3Gs-1750308750-1.0.1.1-f0Y.PUR20pOpa5j9eIFi_.lXwUsAVMfSpfKMR_wJx.tCjVM9aJvuGuKz9s9tLG9V; path=/; expires=Thu, 19-Jun-25 05:22:30 GMT; domain=.upstox.com; HttpOnly; Secure; SameSite=None, _cfuvid=qFxoixn0qWxhKxCxQONd_kq2hzoFB9jQv6Irt2CLFoY-1750308750499-0.0.1.1-604800000; path=/; domain=.upstox.com; HttpOnly; Secure; SameSite=None', 'Server': 'cloudflare', 'CF-RAY': '95206ada5a3972c9-CNN', 'alt-svc': 'h3=":443"; ma=86400'})
HTTP response body: b'{"status":"error","errors":[{"errorCode":"UDAPI100011","message":"Invalid Instrument key","propertyPath":null,"invalidValue":null,"error_code":"UDAPI100011","property_path":null,"invalid_value":null}]}'

2025-06-19 10:22:30,567 - ERROR - Unexpected error fetching NSE_EQ|INE585B01010 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,567 - WARNING - No candle data received for Maruti Suzuki at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,624 - ERROR - Unexpected error fetching NSE_EQ|INE860A01027 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:22:30,624 - WARNING - No candle data received for HCL Technologies at 2025-06-19 10:20:00+05:30
2025-06-19 10:22:30,647 - ERROR - V3 fallback HTTP request failed for NSE_EQ|INE296A01024: 400 Client Error: Bad Request for url: https://api.upstox.com/v3/historical-candle/intraday/NSE_EQ%7CINE296A01024/minutes/1
2025-06-19 10:22:30,648 - WARNING - No candle data received for Bajaj Finance at 2025-06-19 09:15:00+05:30
2025-06-19 10:22:31,698 - INFO - Cycle 2 completed: 0/15 successful, 15 failed
2025-06-19 10:22:31,698 - INFO - Waiting 58.3 seconds until next fetch at 10:23:30
2025-06-19 10:23:30,058 - INFO - === Cycle 3 - 2025-06-19 10:23:30 IST ===
2025-06-19 10:23:30,058 - INFO - Processing 15 symbols with 3 workers
2025-06-19 10:23:30,138 - ERROR - Unexpected error fetching NSE_EQ|INE002A01018 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,138 - WARNING - No candle data received for Reliance Industries at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,178 - ERROR - Unexpected error fetching NSE_EQ|INE009A01021 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,178 - WARNING - No candle data received for Infosys at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,202 - ERROR - Unexpected error fetching NSE_EQ|INE467B01029 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,202 - WARNING - No candle data received for Tata Consultancy Services at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,217 - ERROR - Unexpected error fetching NSE_EQ|INE040A01034 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,217 - WARNING - No candle data received for HDFC Bank at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,240 - ERROR - Unexpected error fetching NSE_EQ|INE090A01021 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,240 - WARNING - No candle data received for ICICI Bank at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,265 - ERROR - Unexpected error fetching NSE_EQ|INE030A01027 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,266 - WARNING - No candle data received for Hindustan Unilever at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,313 - ERROR - Unexpected error fetching NSE_EQ|INE062A01020 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,313 - WARNING - No candle data received for State Bank of India at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,316 - ERROR - Unexpected error fetching NSE_EQ|INE154A01025 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,317 - WARNING - No candle data received for ITC at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,392 - ERROR - Unexpected error fetching NSE_EQ|INE018A01030 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,392 - WARNING - No candle data received for Larsen & Toubro at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,397 - ERROR - Unexpected error fetching NSE_EQ|INE237A01028 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,398 - WARNING - No candle data received for Kotak Mahindra Bank at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,419 - ERROR - Unexpected error fetching NSE_EQ|INE397D01024 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,419 - WARNING - No candle data received for Bharti Airtel at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,469 - ERROR - Unexpected error fetching NSE_EQ|INE021A01026 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,469 - WARNING - No candle data received for Asian Paints at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,475 - ERROR - Unexpected error fetching NSE_EQ|INE585B01010 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,475 - WARNING - No candle data received for Maruti Suzuki at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,483 - ERROR - Upstox V2 API error fetching NSE_EQ|INE296A01024 for 2025-06-19 09:15:00+05:30: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Date': 'Thu, 19 Jun 2025 04:53:30 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'vary': 'Origin, Access-Control-Request-Method, Access-Control-Request-Headers', 'message': 'request failed', 'requestid': '3618f591-0269-4615-894f-69fe87229110', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'Cache-Control': 'no-cache, no-store, max-age=0, must-revalidate', 'pragma': 'no-cache', 'expires': '0', 'strict-transport-security': 'max-age=0; includeSubDomains', 'x-frame-options': 'DENY', 'CF-Cache-Status': 'MISS', 'Set-Cookie': '__cf_bm=GFWuiZtGS12XjziHxfNLOaSBngq2YsVg7Jc58j6daB4-1750308810-1.0.1.1-BiwdFKyvvL16MDCx4I7ErECZ24UKDI3mjIWyKfKiSs98OVBKcbHBZemqRzv7i62F; path=/; expires=Thu, 19-Jun-25 05:23:30 GMT; domain=.upstox.com; HttpOnly; Secure; SameSite=None, _cfuvid=L.d_Y3abwpQfwrvo4JZRriZ6Hs7LFnk69cCVIErVwe4-1750308810450-0.0.1.1-604800000; path=/; domain=.upstox.com; HttpOnly; Secure; SameSite=None', 'Server': 'cloudflare', 'CF-RAY': '95206c51096572c9-CNN', 'alt-svc': 'h3=":443"; ma=86400'})
HTTP response body: b'{"status":"error","errors":[{"errorCode":"UDAPI100011","message":"Invalid Instrument key","propertyPath":null,"invalidValue":null,"error_code":"UDAPI100011","property_path":null,"invalid_value":null}]}'

2025-06-19 10:23:30,537 - ERROR - Unexpected error fetching NSE_EQ|INE860A01027 for 2025-06-19 10:20:00+05:30: unsupported operand type(s) for /: 'str' and 'int'
2025-06-19 10:23:30,538 - WARNING - No candle data received for HCL Technologies at 2025-06-19 10:20:00+05:30
2025-06-19 10:23:30,592 - ERROR - V3 fallback HTTP request failed for NSE_EQ|INE296A01024: 400 Client Error: Bad Request for url: https://api.upstox.com/v3/historical-candle/intraday/NSE_EQ%7CINE296A01024/minutes/1
2025-06-19 10:23:30,593 - WARNING - No candle data received for Bajaj Finance at 2025-06-19 09:15:00+05:30
2025-06-19 10:23:31,642 - INFO - Cycle 3 completed: 0/15 successful, 15 failed
2025-06-19 10:23:31,643 - INFO - Waiting 58.4 seconds until next fetch at 10:24:30
2025-06-19 10:24:01,586 - INFO - Received signal 2, shutting down gracefully...
