2025-06-19 10:27:40,389 - INFO - Live data fetcher logging to: /home/abhishek/projects/CUPCAKE/logs/live_data_fetcher_20250619_102740_IST.log
2025-06-19 10:27:40,390 - INFO - Script directory: /home/abhishek/projects/CUPCAKE/scripts
2025-06-19 10:27:40,390 - INFO - Looking for symbols.json at: /home/abhishek/projects/CUPCAKE/scripts/symbols.json
2025-06-19 10:27:40,390 - INFO - Loaded credentials from /home/abhishek/projects/CUPCAKE/authentication/credentials.json
2025-06-19 10:27:40,390 - INFO - Loaded 15 symbols from /home/abhishek/projects/CUPCAKE/scripts/symbols.json
2025-06-19 10:27:40,395 - INFO - Connected to Redis at localhost:6379, DB 0
2025-06-19 10:27:40,395 - INFO - Starting continuous live data fetching...
2025-06-19 10:27:40,395 - INFO - Monitoring 15 symbols
2025-06-19 10:27:40,395 - INFO - Log file: /home/abhishek/projects/CUPCAKE/logs/live_data_fetcher_20250619_102740_IST.log
2025-06-19 10:27:40,395 - INFO - Performing initial gap filling...
2025-06-19 10:27:40,477 - INFO - === Cycle 1 - 2025-06-19 10:27:40 IST ===
2025-06-19 10:27:40,478 - INFO - Processing 15 symbols with 3 workers
2025-06-19 10:27:40,592 - ERROR - Upstox V2 API error fetching NSE_EQ|INE296A01024 for 2025-06-19 09:15:00+05:30: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Date': 'Thu, 19 Jun 2025 04:57:40 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'vary': 'Origin, Access-Control-Request-Method, Access-Control-Request-Headers', 'message': 'request failed', 'requestid': '13b75781-c9e0-4401-93a6-bcd3ddcdbbbc', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'Cache-Control': 'no-cache, no-store, max-age=0, must-revalidate', 'pragma': 'no-cache', 'expires': '0', 'strict-transport-security': 'max-age=0; includeSubDomains', 'x-frame-options': 'DENY', 'CF-Cache-Status': 'MISS', 'Set-Cookie': '__cf_bm=2i8qgonUeo2yaulXplrSHGxUP41zLVX6ZIbFX5j5Qi8-1750309060-1.0.1.1-95VgrjT09MOxff0TZOHeVrgHx8EHscCn5LUrbpwuabIPFEMCcV_IJO9axqmI4Pnn; path=/; expires=Thu, 19-Jun-25 05:27:40 GMT; domain=.upstox.com; HttpOnly; Secure; SameSite=None, _cfuvid=IWO1YRjVH_LyYmkxXvYpdAqn7WJ1LETlBrZR3d4Y7Ro-1750309060559-0.0.1.1-604800000; path=/; domain=.upstox.com; HttpOnly; Secure; SameSite=None', 'Server': 'cloudflare', 'CF-RAY': '9520726c28e32fe5-CNN', 'alt-svc': 'h3=":443"; ma=86400'})
HTTP response body: b'{"status":"error","errors":[{"errorCode":"UDAPI100011","message":"Invalid Instrument key","propertyPath":null,"invalidValue":null,"error_code":"UDAPI100011","property_path":null,"invalid_value":null}]}'

2025-06-19 10:27:40,689 - ERROR - V3 fallback HTTP request failed for NSE_EQ|INE296A01024: 400 Client Error: Bad Request for url: https://api.upstox.com/v3/historical-candle/intraday/NSE_EQ%7CINE296A01024/minutes/1
2025-06-19 10:27:40,690 - WARNING - No candle data received for Bajaj Finance at 2025-06-19 09:15:00+05:30
2025-06-19 10:27:41,983 - INFO - Cycle 1 completed: 14/15 successful, 1 failed
2025-06-19 10:27:41,983 - INFO - Waiting 48.0 seconds until next fetch at 10:28:30
2025-06-19 10:28:30,048 - INFO - === Cycle 2 - 2025-06-19 10:28:30 IST ===
2025-06-19 10:28:30,049 - INFO - Processing 15 symbols with 3 workers
2025-06-19 10:28:30,157 - ERROR - Unexpected error fetching NSE_EQ|INE009A01021 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,158 - WARNING - No candle data received for Infosys at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,214 - ERROR - Unexpected error fetching NSE_EQ|INE467B01029 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:26:00+05:30'
2025-06-19 10:28:30,214 - WARNING - No candle data received for Tata Consultancy Services at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,236 - ERROR - Unexpected error fetching NSE_EQ|INE002A01018 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,236 - WARNING - No candle data received for Reliance Industries at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,251 - ERROR - Unexpected error fetching NSE_EQ|INE040A01034 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,251 - WARNING - No candle data received for HDFC Bank at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,276 - ERROR - Unexpected error fetching NSE_EQ|INE090A01021 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:26:00+05:30'
2025-06-19 10:28:30,276 - WARNING - No candle data received for ICICI Bank at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,320 - ERROR - Unexpected error fetching NSE_EQ|INE030A01027 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,320 - WARNING - No candle data received for Hindustan Unilever at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,352 - ERROR - Unexpected error fetching NSE_EQ|INE062A01020 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,353 - ERROR - Unexpected error fetching NSE_EQ|INE154A01025 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:26:00+05:30'
2025-06-19 10:28:30,354 - WARNING - No candle data received for State Bank of India at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,354 - WARNING - No candle data received for ITC at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,386 - ERROR - Unexpected error fetching NSE_EQ|INE397D01024 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:26:00+05:30'
2025-06-19 10:28:30,386 - WARNING - No candle data received for Bharti Airtel at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,417 - ERROR - Unexpected error fetching NSE_EQ|INE237A01028 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,417 - WARNING - No candle data received for Kotak Mahindra Bank at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,433 - ERROR - Unexpected error fetching NSE_EQ|INE018A01030 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,433 - WARNING - No candle data received for Larsen & Toubro at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,472 - ERROR - Unexpected error fetching NSE_EQ|INE021A01026 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,473 - WARNING - No candle data received for Asian Paints at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,489 - ERROR - Unexpected error fetching NSE_EQ|INE585B01010 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,489 - WARNING - No candle data received for Maruti Suzuki at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,508 - ERROR - Upstox V2 API error fetching NSE_EQ|INE296A01024 for 2025-06-19 09:15:00+05:30: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Date': 'Thu, 19 Jun 2025 04:58:30 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'vary': 'Origin, Access-Control-Request-Method, Access-Control-Request-Headers', 'message': 'request failed', 'requestid': '190abd1c-439b-4bb4-8c2f-7f198ee3ac88', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'Cache-Control': 'no-cache, no-store, max-age=0, must-revalidate', 'pragma': 'no-cache', 'expires': '0', 'strict-transport-security': 'max-age=0; includeSubDomains', 'x-frame-options': 'DENY', 'CF-Cache-Status': 'MISS', 'Set-Cookie': '__cf_bm=ijEwSwuJN8pqRpLB_BTC5vrAhEZrXyatyZgFyhxRxHI-1750309110-1.0.1.1-UjoFIrmcP21POPiqB6oyTZThcd4x6DrrtKWZygijglHL90oumFdndIzZaQWo1WM8; path=/; expires=Thu, 19-Jun-25 05:28:30 GMT; domain=.upstox.com; HttpOnly; Secure; SameSite=None, _cfuvid=oZ1TKm48kkPbEIZ0026sG09jy_MXtXDCG.706Lx8VrY-1750309110475-0.0.1.1-604800000; path=/; domain=.upstox.com; HttpOnly; Secure; SameSite=None', 'Server': 'cloudflare', 'CF-RAY': '952073a41f7772c9-CNN', 'alt-svc': 'h3=":443"; ma=86400'})
HTTP response body: b'{"status":"error","errors":[{"errorCode":"UDAPI100011","message":"Invalid Instrument key","propertyPath":null,"invalidValue":null,"error_code":"UDAPI100011","property_path":null,"invalid_value":null}]}'

2025-06-19 10:28:30,560 - ERROR - Unexpected error fetching NSE_EQ|INE860A01027 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:28:30,561 - WARNING - No candle data received for HCL Technologies at 2025-06-19 10:27:00+05:30
2025-06-19 10:28:30,605 - ERROR - V3 fallback HTTP request failed for NSE_EQ|INE296A01024: 400 Client Error: Bad Request for url: https://api.upstox.com/v3/historical-candle/intraday/NSE_EQ%7CINE296A01024/minutes/1
2025-06-19 10:28:30,605 - WARNING - No candle data received for Bajaj Finance at 2025-06-19 09:15:00+05:30
2025-06-19 10:28:31,664 - INFO - Cycle 2 completed: 0/15 successful, 15 failed
2025-06-19 10:28:31,665 - INFO - Waiting 58.3 seconds until next fetch at 10:29:30
2025-06-19 10:29:30,047 - INFO - === Cycle 3 - 2025-06-19 10:29:30 IST ===
2025-06-19 10:29:30,047 - INFO - Processing 15 symbols with 3 workers
2025-06-19 10:29:30,139 - ERROR - Unexpected error fetching NSE_EQ|INE002A01018 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:29:30,140 - WARNING - No candle data received for Reliance Industries at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,150 - ERROR - Unexpected error fetching NSE_EQ|INE467B01029 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,150 - WARNING - No candle data received for Tata Consultancy Services at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,164 - ERROR - Unexpected error fetching NSE_EQ|INE009A01021 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,164 - WARNING - No candle data received for Infosys at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,202 - ERROR - Unexpected error fetching NSE_EQ|INE040A01034 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:29:30,203 - WARNING - No candle data received for HDFC Bank at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,229 - ERROR - Unexpected error fetching NSE_EQ|INE090A01021 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,229 - WARNING - No candle data received for ICICI Bank at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,244 - ERROR - Unexpected error fetching NSE_EQ|INE030A01027 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,244 - WARNING - No candle data received for Hindustan Unilever at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,263 - ERROR - Unexpected error fetching NSE_EQ|INE154A01025 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,263 - WARNING - No candle data received for ITC at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,301 - ERROR - Unexpected error fetching NSE_EQ|INE062A01020 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,301 - WARNING - No candle data received for State Bank of India at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,311 - ERROR - Unexpected error fetching NSE_EQ|INE397D01024 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,312 - WARNING - No candle data received for Bharti Airtel at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,341 - ERROR - Unexpected error fetching NSE_EQ|INE237A01028 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,341 - WARNING - No candle data received for Kotak Mahindra Bank at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,365 - ERROR - Unexpected error fetching NSE_EQ|INE018A01030 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:27:00+05:30'
2025-06-19 10:29:30,365 - WARNING - No candle data received for Larsen & Toubro at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,391 - ERROR - Unexpected error fetching NSE_EQ|INE021A01026 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,391 - WARNING - No candle data received for Asian Paints at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,412 - ERROR - Unexpected error fetching NSE_EQ|INE585B01010 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,412 - WARNING - No candle data received for Maruti Suzuki at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,424 - ERROR - Upstox V2 API error fetching NSE_EQ|INE296A01024 for 2025-06-19 09:15:00+05:30: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Date': 'Thu, 19 Jun 2025 04:59:30 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'vary': 'Origin, Access-Control-Request-Method, Access-Control-Request-Headers', 'message': 'request failed', 'requestid': '56c73415-17ac-4bd9-be4e-5a92a195d32d', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'Cache-Control': 'no-cache, no-store, max-age=0, must-revalidate', 'pragma': 'no-cache', 'expires': '0', 'strict-transport-security': 'max-age=0; includeSubDomains', 'x-frame-options': 'DENY', 'CF-Cache-Status': 'MISS', 'Set-Cookie': '__cf_bm=jkqfj5eqNM4u0cWw4PGt3chPIpNyEbuXkeLNDRjhSoQ-1750309170-1.0.1.1-N1NMRN9ZzOR4bJ2WG0dJwWgYpdyxF5AsqMGOh8.gYBZ.KcSEV53UBsheEpu8VjhN; path=/; expires=Thu, 19-Jun-25 05:29:30 GMT; domain=.upstox.com; HttpOnly; Secure; SameSite=None, _cfuvid=A1r0mmHRaR5y81jwDHR.vqNMxrx2i6nx.Jqu_XAP1AA-1750309170390-0.0.1.1-604800000; path=/; domain=.upstox.com; HttpOnly; Secure; SameSite=None', 'Server': 'cloudflare', 'CF-RAY': '9520751aab8472c9-CNN', 'alt-svc': 'h3=":443"; ma=86400'})
HTTP response body: b'{"status":"error","errors":[{"errorCode":"UDAPI100011","message":"Invalid Instrument key","propertyPath":null,"invalidValue":null,"error_code":"UDAPI100011","property_path":null,"invalid_value":null}]}'

2025-06-19 10:29:30,461 - ERROR - Unexpected error fetching NSE_EQ|INE860A01027 for 2025-06-19 10:27:00+05:30: invalid literal for int() with base 10: '2025-06-19T10:28:00+05:30'
2025-06-19 10:29:30,461 - WARNING - No candle data received for HCL Technologies at 2025-06-19 10:27:00+05:30
2025-06-19 10:29:30,525 - ERROR - V3 fallback HTTP request failed for NSE_EQ|INE296A01024: 400 Client Error: Bad Request for url: https://api.upstox.com/v3/historical-candle/intraday/NSE_EQ%7CINE296A01024/minutes/1
2025-06-19 10:29:30,525 - WARNING - No candle data received for Bajaj Finance at 2025-06-19 09:15:00+05:30
2025-06-19 10:29:31,648 - INFO - Cycle 3 completed: 0/15 successful, 15 failed
2025-06-19 10:29:31,648 - INFO - Waiting 58.4 seconds until next fetch at 10:30:30
2025-06-19 10:30:20,163 - INFO - Received signal 2, shutting down gracefully...
